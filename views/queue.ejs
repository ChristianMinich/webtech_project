<html>
  <head> </head>
  <body>
    <h1>In Queue</h1>
    <h2><%= username%></h2>
    <button onclick="joinQueue()">JOIN</button>
    <button onclick="getQuestions()">Question</button>
    <div id="users"></div>

    <div class="quizbox">

      <h2 id="question-text"></h2>
      <div class = "answers" id="option1-text"></div>
      <div class = "answers" id="option2-text"></div>
      <div class = "answers" id="option3-text"></div>
      <div class = "answers" id="option4-text"></div>
  </div>
  
  </body>
  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();
    const username = "<%= username %>";
    const usersDiv = document.getElementById("users");

    function joinQueue() {
      socket.emit("joinQueue", username);
    }

    function getQuestions() {
      socket.emit("questions");
    }

    socket.on("joinGame", (roomID) => {
        //socket.join(roomID);
        window.location.href = "/game/" + roomID;
    });
    
    socket.on("test", (roomID) => {
      
      console.log("Test erfolgreich ! " + roomID);

    });

    socket.on('question', function(question) {
      console.log("Frage erhlaten");
      document.getElementById('question-text').textContent = question.text;
      document.getElementById('option1-text').textContent = question.answers[0];
      document.getElementById('option2-text').textContent = question.answers[1];
      document.getElementById('option3-text').textContent = question.answers[2];
      document.getElementById('option4-text').textContent = question.answers[3];
    });

    socket.on("usersInQueue", (users) => {
      usersDiv.innerHTML = "";

      // Create a table element
      const table = document.createElement("table");

      // Create the table header row
      const headerRow = document.createElement("tr");
      const headerCell1 = document.createElement("th");
      headerCell1.textContent = "Username";
      headerRow.appendChild(headerCell1);
      table.appendChild(headerRow);

      // Iterate over the users array and create table rows
      users.forEach((user) => {
        const row = document.createElement("tr");
        const cell1 = document.createElement("td");
        cell1.textContent = user;
        row.appendChild(cell1);
        table.appendChild(row);
      });

      // Append the table to the usersDiv
      usersDiv.appendChild(table);
    });
    
  </script>
</html>
